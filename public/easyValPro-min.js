/*   Easy Val Pro
     A jQuery/javascript library of useful math and money related functions!
     By: Alex Bezuska 2013

     Table of contents:
        1. form validator
        2. Add commas to normal (?)
        3. Precise decimal rounding (.00)
        4. Convert string to money ($0,000.00)
        5. Input percent equation
        6. Make label red if negative

*/// Form Validator
valThis=function(e,t){idNameVal=$(e).val();if(t==="question"){console.log("question validation...");if(idNameVal.length==0){$(e).parents(".QuestionWrapper").addClass("warning");console.log(" no text present")}else{$(e).parents(".QuestionWrapper").removeClass("warning");console.log(" there is text in the simple box!")}}if(t==="fullName"){console.log("fullName validation...");if(idNameVal.length==0){$(e).parents(".callout").addClass("warning");console.log("bad name")}else{$(e).parents(".callout").removeClass("warning");console.log("good name")}}if(t==="email"){emailFilter=/^([\w-\.]+)@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.)|(([\w-]+\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\]?)$/;if(emailFilter.test(idNameVal)){$(e).parents(".callout").removeClass("warning");console.log("good email")}else{$(e).parents(".callout").addClass("warning");console.log("bad email")}}if(t==="phone"){var n=/\d/g,r=idNameVal.replace(/[^0-9]/g,"");if(n.test(r)){console.log(idNameVal);if(r.length==7||r.length==10||r.length==11){$(e).parents(".callout").removeClass("warning");console.log("good phone");console.log(idNameVal)}else{$(e).parents(".callout").addClass("warning");console.log("bad bad phone");console.log(idNameVal)}}else{console.log(idNameVal);$(e).parents(".callout").addClass("warning");console.log("bad bad phone")}}};commas=function(e){e+="";x=e.split(".");x1=x[0];x2=x.length>1?"."+x[1]:"";var t=/(\d+)(\d{3})/;while(t.test(x1))x1=x1.replace(t,"$1,$2");return x1+x2},precise_round=function(e,t){console.log("Before round: "+e);var n=Math.round(e*Math.pow(10,t))/Math.pow(10,t);console.log("After round: "+n);return n},toMoney=function(e){console.log("-----------------------------------------------\nStarting 'toMoney' function on "+e+"...");var e=e.replace(/[^0-9.-]/g,"");console.log("removed invalid characters: "+e);var t=e.length-1;if(e.indexOf(".")!==-1){console.log("length after decimal:"+e.substring(e.indexOf("."),t).length);if(e.substring(e.indexOf("."),t).length==0){e="$"+e+"00";return commas(e)}if(e.substring(e.indexOf("."),t).length==1){e="$"+e+"0";return commas(e)}if(e.substring(e.indexOf("."),t).length==2){e="$"+e;return commas(e)}alert("mr sandwich");var e=e.replace(/[^0-9.-]/g,"");console.log("value after stripping: "+e);e=precise_round(e);console.log("round: "+e);e="$"+e.toString();return commas(e)}e="$"+e+".00";return commas(e)},getPercentOf=function(e,t,n){console.log("-----------------------------------------------\nStarting 'getPercentOf' function on "+$(e).text()+" and "+$(t).val()+" with destination: "+n+"...");var r=stripMoney(e),i=stripMoney(t),s=r*i/"100";console.log("getPercentOf //  "+i+" % X "+r+" = "+s);s=precise_round(s,2);s=s.toString();s=toMoney(s);var o=$(n).get(0).tagName;if(o=="INPUT"){console.log("getPercentOf // answerLabel type: "+o+" loading "+s+" into it.");$(n).val(s)}else{console.log("getPercentOf // answerLabel type: "+o+" loading "+s+" into it.");$(n).text(s)}};var redOnNegative=function(e){$(e).each(function(){console.log($(this).html());$(this).html().match("-")&&$(this).css("color","rgba(192,57,43,1)")})};stripMoney=function(e){console.log("-----------------------------------------------\nStarting 'stripMoney' function on "+e+"...");elementType=$(e).get(0).tagName;if(elementType=="INPUT"){var t=$(e).val().replace(/[^0-9.-]/g,"");if(isNaN(t)||t==""){console.log("! Found NaN ! Fixing...");t="0.00"}console.log("   Found "+elementType+", with value: "+$(e).val()+" \n   stripping result is: "+t)}else{var t=$(e).text().replace(/[^0-9.-]/g,"");if(isNaN(t)||t==""){console.log("! Found NaN ! Fixing...");t="0.00"}console.log("   Found "+elementType+", with text: "+$(e).text()+" \n   stripping result is: "+t)}return parseFloat(t)};stripNumberString=function(e){console.log("-----------------------------------------------\nStarting 'stripNumberString' function on "+e+"...");console.log("input: "+e);result=e.replace(/[^0-9.-]/g,"");console.log("replace characters: "+result)};addStaticMoney=function(e,t,n){var r=stripMoney(e)+stripMoney(t);r=precise_round(r,2);r=r.toString();r=toMoney(r);var i=$(n).get(0).tagName;i=="INPUT"?$(n).val(r):$(n).text(r)};multiplyUserInputMoney=function(e,t,n){console.log("-----------------------------------------------\nStarting 'multiplyUserInputMoney' function...");input1Val=stripMoney(e);staticInputVal=stripMoney(t);var r=input1Val*staticInputVal;console.log("   Equation: "+input1Val+" x "+staticInputVal+" = "+r);r=precise_round(r,2);console.log("   Total Rounded: "+r);r=r.toString();r=toMoney(r);console.log("   Total to Money: "+r);var i=$(n).get(0).tagName;i=="INPUT"?$(n).val(r):$(n).text(r)};$(document).ready(function(){$('*[data-mask="money"]').each(function(){console.log("out");var e=$(this).val().replace("$","").replace(",","");console.log(e);if(isNaN(e)||e==""){console.log("! Found NaN ! Fixing...");e="0.00";console.log("   Found value: "+$(this).val()+" \n   stripping result is: "+e)}e=toMoney(e);$(this).val(e)});$("*[data-mask='money']").click(function(){$(this).select()});$('*[data-mask="money"]').focus(function(){console.log("in")}).blur(function(){console.log("out");var e=$(this).val().replace("$","").replace(",","");e=toMoney(e);$(this).val(e)});$('*[data-mask="percent"]').each(function(){console.log("start data mask percent");var e=$(this).val().replace("%","");console.log(e);if(isNaN(e)||e==""){console.log("! Found NaN ! Fixing...");e="0.00";console.log("   Found value: "+$(this).val()+" \n   stripping result is: "+e)}e=precise_round(e,2);$(this).val(" "+e+" %")});$("*[data-mask='percent']").focus(function(){console.log("in")}).blur(function(){console.log("out");var e=$(this).val().replace("%","");if(isNaN(e)||e==""){console.log("! Found NaN ! Fixing...");e="0.00";console.log("   Found value: "+$(this).val()+" \n   stripping result is: "+e)}e=precise_round(e,2);$(this).val(" "+e+" %")});$('*[data-mask="number"]').each(function(){console.log("start data mask number");var e=$(this).val().replace(/[^0-9]/g,"");console.log(e);$(this).val(e)});$('*[data-mask="number"]').focus(function(){console.log("in")}).blur(function(){console.log("out");var e=$(this).val().replace(/[^0-9]/g,"");$(this).val(e)});$('*[data-mask="decimal"]').each(function(){console.log("start data mask number");var e=$(this).val().replace(/[^0-9.]/g,"");console.log(e);$(this).val(e)});$('*[data-mask="decimal"]').focus(function(){console.log("in")}).blur(function(){console.log("out");var e=$(this).val().replace(/[^0-9.]/g,"");$(this).val(e)});$('input[type="text"]').click(function(){$(this).select()});average=function(e){var t=0,n=0;$(e).each(function(){var e=$(this).text().replace("$","");console.log(e);t+=parseInt(e);n++});var r=t/n;r=precise_round(r,2);if(isNaN(r)||r=="")r="n/a";return r};countObjects=function(e){i=0;$(e).each(function(){if(isNaN(e)||e=="")e=0;i+=1});return i};addObjects=function(e){i=0;var t=$(e).get(0).tagName;t=="INPUT"?$(e).each(function(){var e=parseFloat($(this).val().replace(/[^0-9.]/g,""));if(isNaN(e)||e=="")e="0";i+=e}):$(e).each(function(){var e=parseFloat($(this).text().replace(/[^0-9.]/g,""));if(isNaN(e)||e=="")e="0";i+=e});if(isNaN(i)||i=="")i="0";return i};setToToday=function(e,t){console.log("gettingtodays date");if(t=="mm/dd/yyyy"||t=="MM/DD/YYYY")var n=new Date,r=n.getMonth()+1+"/"+n.getDate()+"/"+n.getFullYear();else{console.log("EasyVal.js ERROR with function: setToToday()\nThe Bad News: EasyVal.js does not have support for this date format yet, or you have typed in an incorrect date format string(or no date format string). Bummer.\nThe Good News: EasyVal.js has defaulted all requested fields to 'mm/dd/yyyy'.\n\n");r="mm/dd/yyyy"}var i=$(e).get(0).tagName;i=="INPUT"?$(e).val(r):$(e).text(r)}});